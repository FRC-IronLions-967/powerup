<!DOCTYPE HTML>
<html>
<head>
	<title>Pit Scouting</title>
	<link rel='stylesheet' href="w3.css">
	<link rel='stylesheet' href="w3-theme-red.css">
	<link rel='stylesheet' href="style.css">
	<meta name=viewport content="width=device-width">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="scheduleData.js"></script>
	<script src="teamData.js"></script>
	<!-- <script src="incrementing.js"></script> -->
</head>

<body class="w3-theme-d3">
<form onsubmit="return false">

<ul class="w3-navbar w3-theme-l3 w3-round-xxlarge w3-border-black">
	<li><a href='index.html'>Match Scouting</a></li>
	<li><a href="pitscouting.html">Pit Scouting</a></li>
	<li><a href="schedule.php">Schedule</a></li>
	<li><a href="teams.php">Team List</a></li>  
	<li><a href="uploadPic.html">Upload Pictures</a></li>  
</ul>

<div class="w3-panel w3-theme-l3 w3-padding-large w3-round-xxlarge w3-border w3-border-black w3-text-white">
<p class="status">Status info will be displayed here.</p>
<label for="team">Team Number</label><br>
<select id="team" value = "167" name="team">
	<option value="167">167</option>
	<option value="525">525</option>
	<option value="967">967</option>
</select><br>

<p><img src="pics/nopic.jpg" alt="No picture" id="robot_picture" style='max-width: 300px'></p>

<label for="scout_name">Scout Name</label></br>
<input type="text" name="scout_name" value="" id="scout_name">

</div>

<div class="w3-panel w3-theme-l3 w3-padding-large w3-round-xxlarge w3-border w3-border-black w3-text-white">
<div class="title"><h1>Drive</h1></div>

<label for="orient">Drive Orientation</label><br>
<select id="orient" value = "long" name="orient">
	<option value="">???</option>
	<option value="long">Long</option>
	<option value="wide">Wide</option>
</select><br>
<br>

<label for="drivetype">Drive Type</label><br>
<select id="drivetype" value = "skidsteer" name="drivetype">
	<option value="">???</option>
	<option value="skid">Skid/Tank/4WD/6WD/8WD</option>
	<option value="tread">Treads</option>
	<option value="mecanum">Mecanum</option>
	<option value="swerve">Swerve</option>
	<option value="hdrive">H-Drive</option>
	<option value="omni">Omni/Holonomic</option>
</select><br>
<br>

<label for="transmission">Transmission</label><br>
<select id="transmission" name="transmission">
	<option value="">Single Speed</option>
	<option value="2spd">Two Speed Shifter</option>
</select><br>
<br>

<label for="motors_type">Type of Drive Train Motors</label>
<select id="motors_type">
	<option value="CIM">CIM</option>
	<option value="MiniCIM">MiniCIM</option>
	<option value="775Pro">775Pro</option>
</select><br><br>

<label for=""># of Motors in Drive Train</label></br>
<em>(do not include motors from manipulators)</em></br>
<button class = "m1" id="m1driveMotors">-1</button>
<input type="number" value="4" id="driveMotors" name="driveMotors" min="0" max = "8">
<button class="p1" id="p1driveMotors">+1</button><br>
<br>

<label for="">Weight (no battery/bumpers)</label></br>
<button class = "m1" id="m1weight">-1</button>
<input type="number" value="115" id="weight" name="weight" min="50" max = "140">
<button class="p1" id="p1weight">+1</button><br>
<br>
</div>

<div class="w3-panel w3-theme-l3 w3-padding-large w3-round-xxlarge w3-border w3-border-black w3-text-white">
<div class="title"><h1>Manipulators</h1></div>

<label for="floor_pickup">Floor Cube Pickup</label>
<input type="checkbox" name="floor_pickup" id="floor_pickup"><br>

<label for="portal_receive">Portal - Receive Cube from Human</label>
<input type="checkbox" name="portal_receive" id="portal_receive"></br>

<label for="portal_deliver">Portal - Deliver Cube to Human</label>
<input type="checkbox" name="portal_deliver" id="portal_deliver"></br>

<label for="place_switch">Place Cube on Switch</label>
<input type="checkbox" name="place_switch" id="place_switch"></br>

<label for="place_scale">Place Cube on Scale</label>
<input type="checkbox" name="place_scale" id="place_scale"></br>

<label for="climb_solo">Climb - Solo</label>
<input type="checkbox" name="climb_solo" id="climb_solo"></br>

<label for="climb_partner">Be Lifted By Partner</label>
<input type="checkbox" name="climb_partner" id="climb_partner"></br>

<label for="climb_assist">Climb - Assist Other</label>
<input type="checkbox" name="climb_assist" id="climb_assist"></br>
</div>

<div class="w3-panel w3-theme-l3 w3-padding-large w3-round-xxlarge w3-border w3-border-black w3-text-white">
<div class="title"><h1>Autonomous</h1></div>

<strong>Programming Language</strong><br>
<select id="language">
	<option value="">???</option>
	<option value="C++">C++</option>
	<option value="Java">Java</option>
	<option value="Labview">Labview</option>
	<option value="Python">Python</option>
</select><br>
<label for="open_source">Open Source / Code on web?</label>
<input type="checkbox" name="open_source" id="open_source"><br><br>


<strong>Intended Capabilities:</strong></br>

<label for="auto_baseline">Cross Baseline (drive forward)</label>
<input type="checkbox" name="auto_baseline" id="auto_baseline"><br>      

<label for="auto_switch">Place Cube in Switch</label>
<input type="checkbox" name="auto_switch" id="auto_switch"><br>

<label for="auto_scale">Place Cube in Scale</label>
<input type="checkbox" name="auto_scale" id="auto_scale"><br>

<label for="multi_auto">Place MULTIPLE Cubes</label>
<input type="checkbox" name="multi_auto" id="multi_auto"><br><br>

<strong>Auto Start Position(s):</strong></br>
<label for="start_center">start_center</label>
<input type="checkbox" name="start_center" id="start_center"><br>

<label for="start_left">start_left</label>
<input type="checkbox" name="start_left" id="start_left"><br>

<label for="start_right">start_right</label>
<input type="checkbox" name="start_right" id="start_right"><br>
</div>

<div class="w3-panel w3-theme-l3 w3-padding-large w3-round-xxlarge w3-border w3-border-black w3-text-white">
<div class="title"><h1>Appearance</h1></div>
<label for="build_appearance">Build Appearance</label><br>
<select id="build_appearance" value = "build_average" name="build_appearance">
	<option value="">Neutral</option>
	<option value="build_concerns">Concerns Noted</option>
	<option value="well_built">Well Built</option>
</select><br>
<br>

<label for="wiring_appearance">Wiring Appearance</label><br>
<select id="wiring_appearance" value = "wiring_average" name="wiring_appearance">
	<option value="">Neutral</option>
	<option value="wiring_concerns">Concerns Noted</option>
	<option value="wiring_organized">Well Organized</option>
</select><br>

</div>

<div class="w3-panel w3-theme-l3 w3-padding-large w3-round-xxlarge w3-border-black w3-text-white w3-margin-left w3-margin-right">
<h3>Comments</h3>
<textarea placeholder="Write Comments Here" name="pit_comments" value="" id="pit_comments" style="width:300px; height:150px"></textarea>
</div>
<br>
<div><input type="submit" id="submit" value="Submit" onclick="submitData()"></div>
<p class="status">Status info will be displayed here.</p>
</div>

<script>
function submitData(){
	document.getElementsByClassName('status')[0].innerHTML = "Starting Request";
	document.getElementsByClassName('status')[1].innerHTML = "Starting Request";

	var xhr = new XMLHttpRequest();
	var params = '';
	params += 'team=' + document.getElementById('team').value;
	params += '&event_code=mokc2';
	params += '&scout_name=' + document.getElementById('scout_name').value;
	params += '&orient=' + document.getElementById('orient').value;
	params += '&drivetype=' + document.getElementById('drivetype').value;
	params += '&transmission=' + document.getElementById('transmission').value;
	params += '&driveMotors=' + document.getElementById('driveMotors').value;
	params += '&weight=' + document.getElementById('weight').value;
	params += '&motors_type=' + document.getElementById('motors_type').value;
	params += '&floor_pickup=' + (document.getElementById('floor_pickup').checked ? 1:0);
	params += '&portal_receive=' + (document.getElementById('portal_receive').checked ? 1:0);
	params += '&portal_deliver=' + (document.getElementById('portal_deliver').checked ? 1:0);
	params += '&place_switch=' + (document.getElementById('place_switch').checked ? 1:0);
	params += '&place_scale=' + (document.getElementById('place_scale').checked ? 1:0);
	params += '&climb_solo=' + (document.getElementById('climb_solo').checked ? 1:0);
	params += '&climb_partner=' + (document.getElementById('climb_partner').checked ? 1:0);
	params += '&climb_assist=' + (document.getElementById('climb_assist').checked ? 1:0);
	params += '&auto_baseline=' + (document.getElementById('auto_baseline').checked ? 1:0);
	params += '&auto_switch=' + (document.getElementById('auto_switch').checked ? 1:0);
	params += '&auto_scale=' + (document.getElementById('auto_scale').checked ? 1:0);
	params += '&multi_auto=' + (document.getElementById('multi_auto').checked ? 1:0);
	params += '&start_center=' + (document.getElementById('start_center').checked ? 1:0);
	params += '&start_left=' + (document.getElementById('start_left').checked ? 1:0);
	params += '&start_right=' + (document.getElementById('start_right').checked ? 1:0);
	params += '&build_appearance=' + document.getElementById('build_appearance').value;
	params += '&wiring_appearance=' + document.getElementById('wiring_appearance').value;
	params += '&pit_comments=' + document.getElementById('pit_comments').value;
	params += '&language=' + document.getElementById('language').value;
	params += '&open_source=' + (document.getElementById('open_source').checked ? 1:0);
	xhr.onreadystatechange = function(){
		if(this.readyState == 4 & this.status == 200){
			document.getElementsByClassName('status')[0].innerHTML = this.responseText;
			document.getElementsByClassName('status')[1].innerHTML = this.responseText;
		}
	}
	
	xhr.open("POST", "insert_pit_record.php", true); 
	xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhr.send(encodeURI(params));
	document.getElementsByClassName('status')[0].innerHTML = "Sending Request...";	
	document.getElementsByClassName('status')[1].innerHTML = "Sending Request...";
}

function updateTeams(arr){
	var teamList = [];
		for (i = 0; i < teamData.length; i++){
			teamList.push({num: parseInt(teamData[i]["team_number"]),
				nick: teamData[i]["nickname"]});
		}

	teamList.sort(function comp(a, b){return parseInt(a['num'])-parseInt(b['num'])});

	var choices = '';
	for(i = 0; i < teamList.length; i++){
		var num = teamList[i]['num'];
		var nick = teamList[i]['nick']
		choices += '<option value="'+num+'">'+num+' - '+nick.substring(0,22)+'</option>\n';
	}
	document.getElementById('team').innerHTML = choices;
}

function lookupTeamData(){
	document.getElementsByClassName('status')[0].innerHTML = "Starting Request";
	document.getElementsByClassName('status')[1].innerHTML = "Starting Request";

	var xhr = new XMLHttpRequest();
	xhr.onreadystatechange = function(){
		if(this.readyState == 4 & this.status == 200){
			if (xhr.responseText != 'null'){
				document.getElementsByClassName('status')[0].innerHTML = "Scouting data exists for team " + document.getElementById('team').value;
				document.getElementsByClassName('status')[1].innerHTML = "Scouting data exists for team " + document.getElementById('team').value;

				var data = JSON.parse(xhr.responseText);

				document.getElementById('scout_name').value = data['scout_name'];
				document.getElementById('orient').value = data['orient'];
				document.getElementById('drivetype').value = data['drivetype'];
				document.getElementById('transmission').value = data['transmission'];
				document.getElementById('driveMotors').value = data['driveMotors'];
				document.getElementById('weight').value = data['weight'];
				document.getElementById('motors_type').value = data['motors_type'];
				document.getElementById('floor_pickup').checked = !! + data['floor_pickup'];
				document.getElementById('portal_receive').checked = !! + data['portal_receive'];
				document.getElementById('portal_deliver').checked = !! + data['portal_deliver'];
				document.getElementById('place_switch').checked = !! + data['place_switch'];
				document.getElementById('place_scale').checked = !! + data['place_scale'];
				document.getElementById('climb_solo').checked = !! + data['climb_solo'];
				document.getElementById('climb_partner').checked = !! + data['climb_partner'];
				document.getElementById('climb_assist').checked = !! + data['climb_assist'];
				document.getElementById('auto_baseline').checked = !! + data['auto_baseline'];
				document.getElementById('auto_switch').checked = !! + data['auto_switch'];
				document.getElementById('auto_scale').checked = !! + data['auto_scale'];
				document.getElementById('multi_auto').checked = !! + data['multi_auto'];
				document.getElementById('start_center').checked = !! + data['start_center'];
				document.getElementById('start_left').checked = !! + data['start_left'];
				document.getElementById('start_right').checked = !! + data['start_right'];
				document.getElementById('build_appearance').value = data['build_appearance'];
				document.getElementById('wiring_appearance').value = data['wiring_appearance'];
				document.getElementById('pit_comments').value = data['pit_comments'];
				document.getElementById('language').value = data['language'];
				document.getElementById('open_source').checked = !! + data['open_source'];

				//console.log(data['orient']);
				//console.log(data['floor_pickup']);


			}
			else {
				document.getElementsByClassName('status')[0].innerHTML = "No data yet for team " + document.getElementById('team').value;
				document.getElementsByClassName('status')[1].innerHTML = "No data yet for team " + document.getElementById('team').value;	

				document.getElementById('scout_name').value = "";
				document.getElementById('orient').value = "";
				document.getElementById('drivetype').value = "";
				document.getElementById('transmission').value = "";
				document.getElementById('driveMotors').value = "";
				document.getElementById('weight').value = "";
				document.getElementById('motors_type').value = "";
				document.getElementById('floor_pickup').checked = false;
				document.getElementById('portal_receive').checked = false;
				document.getElementById('portal_deliver').checked = false;
				document.getElementById('place_switch').checked = false;
				document.getElementById('place_scale').checked = false;
				document.getElementById('climb_solo').checked = false;
				document.getElementById('climb_partner').checked = false;
				document.getElementById('climb_assist').checked = false;
				document.getElementById('auto_baseline').checked = false;
				document.getElementById('auto_switch').checked = false;
				document.getElementById('auto_scale').checked = false;
				document.getElementById('multi_auto').checked = false;
				document.getElementById('start_center').checked = false;
				document.getElementById('start_left').checked = false;
				document.getElementById('start_right').checked = false;
				document.getElementById('build_appearance').value = "";
				document.getElementById('wiring_appearance').value = "";
				document.getElementById('pit_comments').value = "";
				document.getElementById('language').value = "";
				document.getElementById('open_source').checked = false;
			}
		}
		else{
			document.getElementsByClassName('status')[0].innerHTML ="Looking for team " + document.getElementById('team').value + " data...";
			document.getElementsByClassName('status')[1].innerHTML ="Looking for team " + document.getElementById('team').value + " data...";
		}
	};
	xhr.open('GET', 'pit_team_get.php?team=' + document.getElementById('team').value);
	xhr.send();
}

document.addEventListener("DOMContentLoaded", function() {
	//Document ready function
	updateTeams(teamData);
	document.getElementById('team').addEventListener("change", function(){
		lookupTeamData();
		document.getElementById('robot_picture').src = "pics/"+document.getElementById('team').value+".jpg";
	});
});

plus = document.getElementsByClassName('p1');
for (i=0; i<plus.length; i++){
	var val_id = plus[i].id.substring(2);
	plus[i].addEventListener("click",closure(val_id, 1));
}

minus = document.getElementsByClassName('m1');
for (i=0; i<minus.length; i++){
	var val_id = minus[i].id.substring(2);
	minus[i].addEventListener("click",closure(val_id, -1));
}

function closure(id, amt){
	return function(){
		if ( parseInt(document.getElementById(id).value) + amt >= 0){
			document.getElementById(id).value = parseInt(document.getElementById(id).value) + amt;
		}
	}
}


</script>
</body>
</html>
